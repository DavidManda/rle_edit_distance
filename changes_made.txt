This is the list of changes and additions I made to the algorithm:

- propagating over match block (addition)
